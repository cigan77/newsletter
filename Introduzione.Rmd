---
title: "Keep Calm and EnGioI Statistics"
author: "Andrea Sansone & Angelo Cignarelli"
date: '`r format(Sys.time(), "%d %B %Y")`'
output:
  tufte::tufte_handout:
    highlight: tango
    citation_package: natbib
    latex_engine: xelatex
  tufte::tufte_book:
    citation_package: natbib
    latex_engine: xelatex
  tufte::tufte_html: default
subtitle: La Statistica, questa sconosciuta
link-citations: yes
---

```{r setup, include=FALSE}
library(tufte)
# invalidate cache when the tufte version changes
knitr::opts_chunk$set(tidy = FALSE, cache.extra = packageVersion('tufte'))
options(htmltools.dir.version = FALSE)
```

# Introduzione all'introduzione
> Gli scienziati hanno calcolato che le reali probabilità di esistenza di una cosa effettivamente assurda come questa siano una su un miliardo.
> I maghi, invece, hanno calcolato che le probabilità stimate una su un miliardo si avverano nove volte su dieci.
>
> `r tufte::quote_footer('--- Terry Pratchett, _Morty l\'Apprendista_')`


`r newthought('Se state leggendo queste righe,')` è verosimile che abbiate ricevuto un invito tramite mail, Facebook, o un avviso da qualche collega in merito a una newsletter di statistica spiegata in temini popolari, alla portata di tutti e soprattutto senza sborsare un quattrino. Certo, è possibile che siate finiti per caso in possesso di questo file, ma sinceramente riteniamo abbastanza improbabile che sia stato solo un caso^[Non entreremo per ora in merito a _quanto_ possa essere probabile questo - diciamo decisamente poco, comunque.].  
Probabilmente vi starete domandando il perché di questa newsletter. Ci sono diverse risposte: la prima è che siamo senza dubbio due narcisisti assolutamente privi di vergogna^[E ci mancherebbe altro. Siamo bellissimi.] ma la più probabile è che, per quanto vi possa sembrare assurdo, _ci piace_ fare statistica e divulgare, divulgare forte. Chiacchierando e scambiandoci appunti, ci siamo resi conto che sarebbe potuto tornare utile unire tutto questo materiale (invece di conservarli stile Gollum), con l'obiettivo di realizzare qualcosa più comprensibile, più interessante e, perché no, più divertente per tutti quelli che ritengono che la statistica sia una materia imperscrutabile.  
Riassumere in pochi appuntamenti mensili il contenuto di dozzine di trattati di statistica, rendendoli al contempo di facile comprensione, ci sembra ovviamente un'impresa titanica. Noi faremo del nostro meglio per scrivere un testo che possa aiutare _concretamente_ studenti di medicina, medici in formazione specialistica, biologi, biotecnologi, dottorandi o semplici curiosi ad acquisire capacità di base per raccogliere correttamente i dati, per analizzarli, per utilizzarli nella preparazione di una tesi o, perché no, nello scrivere un articolo scientifico.  
Non siamo statistici, anche se forse, in un'altra vita^[Per chi non crede nella reincarnazione, togliere "in un'altra vita"], lo diventeremo, e quindi è più che probabile^[Di nuovo, non ci occuperemo di quantificare questa probabilità!] che ci scappi qualche errore qua e là. I numeri non mentono, ma gli uomini possono sbagliare! _(PS: apparentemente, anche i software possono sbagliare. Quello che usiamo per scrivere questa newsletter, in particolare, ha deciso di ignorare ogni regola di grammatica per andare a capo. Abbiate pazienza, questi strafalcioni non sono colpa delle nostre maestre elementari!)_

# Preconcetti comuni nella statistica

Prima di iniziare realmente questa newsletter, vale la pena fare coming out e confessare quali sono le frasi comuni che ci fanno venire i tic nervosi.  
`r newthought('"Ma la statistica è difficile"')` è la prima, e più temibile. Già, statistica è difficile. *E invece anatomia patologica o biochimica FISCHI.* Però quando toccava preparare uno di questi esami abbiamo tutti scoperto che si può diventare dipendenti dalla Red Bull, mentre per dedicare qualche ora allo studio di statistica apriti cielo! La statistica in ambito bio-medico, fortunatamente, non è così terribile come sembra. I software più popolari (SPSS, STATA, R, etc...) consentono di fare in pochi istanti operazioni altrimenti molto dispendiose in termini di tempo ed energie; in più, i dati sono l'unica cosa che non mancano in ambito ospedaliero o in un laboratorio. 
<!--Magari non abbiamo la carta per far sdraiare i pazienti sul lettino^[Ma almeno abbiamo un lettino!] ma grazie alla nostra #professione possiamo recuperare un quantitativo indecoroso di dati.-->
Peso, altezza, cellule sane/cellule cancerose, punteggi dei più disparati indici o concentrazioni dei più misconosciuti ormoni... tutto a portata di mano, basta avere un PC, inserire tutto in un foglio Excel e poi decidersi ad analizzarli in maniera appropriata. Ci vogliono un po' di tempo e voglia per imparare almeno le basi per farlo: insomma, si può fare!^[![](Frankenstein.png){ width=35% }]


`r newthought('"Vabbè, ma io raccolgo i dati, poi li porto allo statistico e ci pensa lui"')` è un'altro buon modo per scatenare la furia omicida dello statistico. Grosso modo è come dire "Ora vado a comprare un chilo di spaghetti, due uova, un po' di guanciale, una spolverata di pecorino, butto tutto a caso in un pentolone e poi tanto la carbonara si cuoce da sola"^[Andrea ci tiene a sottolineare che ogni altro esempio culinario è stato brutalmente seviziato dall'introduzione dei robot da cucina.]. Se uno non sa a che servono i dati, o non sa come raccoglierli, o non sa come costruire un questionario, le cose andranno sicuramente male. E spesso anche uno statistico non è in grado di risolvere il problema, anche a fronte di un campione di popolazione immenso. Quasi tutti i libri di statistica raccontano la brillante storia del _Literary Digest_ e del suo sondaggio sulle elezioni presidenziali americane del 1936 (_e il fatto che ancora si parli di una cosa risalente a 80 anni fa la dice lunga_)^[Questa è una delle tre cose che si trovano in praticamente tutti i libri di statistica. Le altre le scoprirete a tempo debito.]. Il _Literary Digest_ fece un sondaggio sulla popolazione americana in occasione delle elezioni che vedevano confrontarsi Alfred Landon e Franklin Delano Roosevelt: già nei precedenti turni elettorali il _Literary Digest_ aveva indicato con una precisione quasi assoluta il vincitore delle elezioni con un largo anticipo. Nel 1936, oltre 10 milioni di individui - una cifra astronomica anche per gli standard attuali - furono intervistati, e circa 2.5 milioni di individui risposero. Secondo gli autori del _Digest_, il vincitore sarebbe stato Landon... che invece fu sconfitto con una percentuale schiacciante. Perché? Semplicemente, l'errore fu nel campionamento: i soggetti intervistati erano gli abbonati del _Digest_, i possessori di automobili e i possessori di un telefono. Gli elettori di Roosevelt appartenevano alla popolazione esclusa dal sondaggio - e probabilmente anche la mancata risposta al questionario da parte di circa 3/4 degli intervistati ha avuto un suo peso. Morale della favola, onde evitare di fare la finaccia che ha fatto il _Digest_ (fallito miseramente), conviene sapere cosa significa fare statistica se non altro per evitare di fare studi inconcludenti o, peggio, irrealistici.

`r newthought('"Ma alla fine basta che la p sia inferiore a 0.05, no?"')` è la riprova che invece il vostro interlocutore qualcosa di statistica lo ha appreso... ma ha deciso di tagliare tutte le parti importanti intorno a questo semplice concetto. Sì, è sempre bello quando compare quel numerino, ma per far le cose per bene toccherà andare un po' più in profondità. Innanzitutto, dimentichiamoci che un test statistico (i.e. t di Student) possa essere sempre valido in ogni situazione: senza entrare troppo nel dettaglio (per ora), se i dati non mostrano un andamento _normale_<!--sono fortemente asimmetrici o devianti rispetto alla normalità -->^[La curva normale è la curva gaussiana che sicuramente un vostro prof di statistica vi ha fatto vedere. Se non vi ricordate, è questa qui sotto. Ne parleremo approfonditamente in una prossima puntata] usare dei test impropri porta a risultati scorretti, ed in quel caso, anche se la significatività statistica dovesse salvarvi, nulla potrà sottrarvi dal giudizio inclemente di chi _sa_ di statistica e dalla conseguente figuraccia.
```{r curvaGaussiana, echo=FALSE, fig.cap="Curva Gaussiana", fig.height=3.5, fig.margin=TRUE, fig.width=3.5, cache=TRUE}
library(ggplot2)
ggplot(data.frame(x = c(-5, 5)), aes(x)) + stat_function(fun = dnorm)
```
Inoltre, dire "p inferiore a zero punto zero cinque" è molto, molto poco specifico; la cosa più corretta sarebbe indicare, con una'adeguata approssimazione (tipo alla terza cifra decimale), il reale valore del vostro^[o della vostra, a seconda del vostro orientamento] _p_.   Pensatevi: vi sentireste più presi in giro da un commerciante che vi dice che il vostro oggetto concupito costa "meno di 50 euro", o da uno che vi dice "esattamente 49.9 euro"? Esempi stupidi a parte, c'è stato recentemente un **_position statement_** ([__link__](http://www.tandfonline.com/doi/full/10.1080/00031305.2016.1154108)) da parte della American Statistical Association finalizzato a rivalutare il ruolo del tanto adorato p statistico. Inoltre, il p-value non rappresenta l'entità dell'effetto: alcuni dati possono risultare molto significativi da un punto di vista statistico, ma irrilevanti da un punto di vista clinico o biologico^[Immaginate quanto possa essere rilevante l'aumento significativo di 1 grammo di peso corporeo o di 1% dell'espressione di un gene]. Pertanto, la statistica non è solo p-value, ma anche di questo ne parleremo diffusamente in seguito.

Ora che abbiamo concluso questo simpaticissimo preambolo, andiamo al sodo... Iniziamo a parlare di dati!

# I dati, o per meglio dire, le variabili

`r newthought('Il primo passo per capire i dati')` è riconoscere cosa sono, come sono fatti, e le sostanziali differenze tra di loro. Paragonare mele e arance è proabilmente poco sensato se non sappiamo di cosa stiamo parlando. La prima, fondamentale distinzione è fra variabili _qualitative_ e _quantitative_.
Le variabili _qualitative_ esprimono, appunto, una qualità. Il genere (maschile e femminile) è un esempio di variabile qualitativa. Altri esempi possono essere vivo/morto^[La variabile "lunedì mattina" non è considerata in ambito scientifico, purtroppo], il colore dei capelli, o il materiale di cui è composto un oggetto. In pratica, le variabili qualitative non sono misurabili in termini numerici. Alcune di queste variabili possono avere un loro ordine, in cui ogni possibile risposta si colloca in una sorta di gradazione: ad esempio, "insufficiente", "sufficiente", "buono", "distinto" e "ottimo" sono variabili qualitative _ordinali_. Se non esiste un ordine prefissato, le variabili sono definite semplicemente _nominali_.  
Le variabili _quantitative_ invece sono numeriche e pertanto misurabili. Possono essere _continue_ o _discrete_: le prime sono indicative di una quantità continua (ad esempio, il numero di metri percorsi in una passeggiata) mentre le altre sono indicative di una quantità numerica ben definita (ad esempio, il numero di ruote che possiede un veicolo - non può possedere tre ruote e mezza!). Le variabili possono essere inoltre quantitative _per scala di rapporti_ o _di intervalli_: questa ulteriore distinzione è un po' più astrusa, probabilmente, ma è facilmente spiegata da un paio di esempi. Il peso è una variabile per scala di rapporti: non possiamo cambiare lo 0 perché non avrebbe senso parlare di una cosa che pesa "meno 10 kg". La temperatura espressa in gradi Celsius è invece una variabile quantitativa per scala di intervalli: lo 0 è un'entità numerica fissata arbitrariamente^[La scala Kelvin invece ha uno 0 assoluto, per cui è una variabile per scala di rapporti.]. Ha senso dire che una cosa pesa il doppio di un'altra, mentre ha meno senso dire che una giornata è "il doppio più calda" di un'altra.

## A che ci serve sapere i diversi tipi di variabili?

Da un punto di vista prettamente logico, a nulla. Da un punto di vista statistico, alcune misurazioni sono attuabili solo per alcuni tipo di variabile. Non è possibile, chiaramente, calcolare la media fra due colori: tuttavia, non è molto difficile intuirlo "a naso", senza andare a scomodare la classificazione. 

# Misure di tendenza centrale e di dispersione delle variabili

##Indici di tendenza centrale: media, mediana, moda
A un certo punto, dopo aver raccolto tutti i dati che ci interessano (e magari qualcuno che non ci interessa, ma non si sa mai cosa ha in serbo il futuro), siamo pronti ad effettuare una prima analisi. La prima cosa che si fa è abitualmente stimare come i nostri dati sono distribuiti: è possibile che siano tutti concentrati in uno spazio molto ristretto,o al contrario è possibile che siano molto lontani l'uno dall'altro. Gli indici di tendenza centrale servono a capire verso dove tende la nostra distribuzione; la dispersione, al contrario, indica quanto i dati siano distanti da questi indici.

`r newthought('La media')` è il primo indice di tendenza centrale ed il più noto. Si tratta, molto semplicemente, della somma delle variabili diviso il numero delle osservazioni. In soldoni, se voglio sapere l'altezza media di un gruppo di persone, mi basta fare la somma delle loro altezze e dividerle per il numero di persone che ho esaminato^[Ma se vi siete laureati immagino che almeno una volta nel vostro percorso di studi abbiate calcolato la vostra media, no?]. Se ad esempio la popolazione che stiamo analizzando (una squadra di pallacanestro, probabilmente) presenta altezze di 180, 180, 184, 186, 190, 195 cm la media della popolazione sarà (180+180+184+186+190+195)/6, o `r round((180+180+184+186+190+195)/6, 2)`.
`r newthought('La mediana')` è invece il valore della variabile che si trova esattamente al centro della distribuzione dopo averla ordinata (cioè messa in ordine di grandezza). Se abbiamo 5 valori, la mediana casca sul terzo; se ne abbiamo 7, sul quarto; e così via. Se la nostra popolazione ha un numero pari di soggetti, come ad esempio per i soggetti citati a proposito della media, la mediana casca a metà fra i due valori centrali - quindi fra a metà fra 184 e 186. La mediana della popolazione è quindi 185.
`r newthought('La moda')` è l'ultimo dei tre indici di tendenza centrale^[In realtà ce ne sono molti altri, come ad esempio la media ponderata, la media armonica, la media geometrica; per quanto ci riguarda, almeno per il momento lasciamo da parte questi indici.]. La moda indica il valore più rappresentato, cioè quello che compare più volte nella popolazione in esame. Pertanto la moda della nostra squadra di pallacanestro corrisponde a 180. A differenza della mediana, se ci sono due valori ugualmente rappresentati la mediana corrisponde ad entrambi i valori; la distribuzione viene quindi definita "bimodale" (o trimodale, e via dicendo). 

Chiaramente non tutti gli indici di tendenza centrale sono applicabili a tutte le variabili. La media fra i colori degli occhi non può esistere; la mediana fra variabili nominali non ha senso a meno di non avere variabili ordinali. La moda, invece, può essere calcolata per tutte le variabili: è ad esempio possibile sapere quale sia il nome proprio più comune in Italia^[Il sito dell'ISTAT [(__link__)](http://www.istat.it/it/prodotti/contenuti-interattivi/calcolatori/nomi) ha un simpatico strumento per scoprirlo, anno per anno.].

## Gli indici di dispersione
Come detto poco sopra, gli indici di dispersione rappresentano la misura della (appunto) dispersione dei valori rispetto ad un parametro centrale.
`r newthought('La varianza')` è una stima dell'accuratezza della media. Nell'esempio di prima sulla popolazione di giocatori di basket avevamo indicato che la media è intorno a 185.83 cm. Una media simile può derivare, tuttavia, da popolazioni totalmente diverse: ad esempio, in una popolazione di sole persone di 185.83 cm, la media sarà di 185.3 cm. Ma vale anche l'opposto: in una popolazione di sei persone alte 150, 150, 154, 216, 220 e 225 cm la media è comunque di 185.83 cm. Non è molto difficile intuire che ci siano delle differenze fra le popolazioni, e la varianza ci offre una buona stima di quanto la popolazione si discosti dalla media.  
Come si calcola la varianza? Si parte dalla somma dei quadrati delle differenze rispetto alla media^[Perchè dei quadrati, vi chiederete? Perché la somma delle differenze rispetto alla media è... zero! Provateci da soli se non ci credete.] e la si divide per il numero dei soggetti in esame _meno uno_: sul perché di questa scelta torneremo in un secondo momento, ma per ora mettiamo nel cassetto questa informazione... Torniamo al nostro esempio iniziale: sappiamo che la media è 185.83, quindi per la prima popolazione la varianza si calcolerà così:
$$
\frac{(180-185.83)^2+(180-185.83)^2+(184-185.83)^2+(186-185.83)^2+(190-185.83)^2+(195-185.83)^2}{5}
$$
$$
\frac{(-5.83)^2+(-5.83)^2+(-1.83)^2+(0.17)^2+(4.17)^2+(9.17)^2}{5}
$$
$$
\frac{172.8334}{5}
$$
Il risultato di questa formula è 28.80556. Quindi possiamo concludere che l'errore medio fra la media e le singole osservazioni è 34.567 cm... quadrati. Già, visto e considerato che abbiamo calcolato una somma di quadrati abbiamo un errore espresso in centimetri quadrati, che non è proprio il massimo della vita. A questo punto, indovina indovinello, cosa succede se calcoliamo la radice quadrata della varianza?
 
`r newthought('La deviazione standard')`, ecco che succede! La deviazione standard (DS) è la radice quadrata della varianza, ed è un'ulteriore, più affidabile stima dell'adeguatezza della media alla popolazione. Senza rifare tutti i calcoli (del resto i software statistici servono anche a questo!), riprendiamo in esame la popolazione numero 3, quella con 3 persone bassine e 3 giganti. Le loro altezze erano rispettivamente 150, 150, 154, 216, 220 e 225 cm; in questo caso la varianza è 1198.806. Le deviazioni standard per le due popolazioni sono quindi circa 5.88 cm e 34.63 cm. Quando troviamo deviazioni standard più ampie, generalmente è un indizio che la media non è un buon parametro di stima della popolazione. E nella popolazione di cloni (quella con tutte persone della stessa altezza) che succede? La media è sempre quella, ma la varianza è uguale a 0 e pertanto anche la DS è uguale a 0. 
`r newthought('Il range interquartile')` è l'ultima misura di dispersione di cui ci occupiamo. In pratica, sappiamo che la mediana divide a metà le nostre osservazioni, giusto? Del resto, è il valore che si trova esattamente a metà dopo aver ordinato i valori della nostra variabile. Escluso il valore della mediana, ci sono quindi 50% di valori al di sotto e 50% al di sopra della mediana. Se dividiamo a metà queste due metà, la conseguenza è che otteniamo una ripartizione in 4 parti uguali della nostra casistica. Ci sarà quindi un valore corrispondente al 25% delle osservazioni, uno al 50% (la mediana), ed uno al 75%. Si definisce range interquartile (IQR) la "metà centrale" delle osservazioni - quindi il valore al 75% (definito il _75° percentile_) meno quello al 25% (il _25° percentile_). Esempio pratico: stiamo valutando una classe universitaria di 101 elementi. A tutti questi studenti è stato dato un compito, con un punteggio minimo di 0 e uno massimo di 200. Siccome in questa classe nessuno copia, i punteggi sono tutti diversi fra di loro e, per un bizzarro caso, sono tutti compresi fra 50 e 150. Quindi uno studente ha preso 50, uno 51, uno 52, e via dicendo fino alla fine con il secchione della classe che ha preso 150. La media della classe è 100, la mediana è ugualmente 100. Il 25% percentile casca a metà fra l'osservazione numero 1 (50) e la mediana (100), ed è 75; il 75% percentile casca a metà fra la mediana e l'osservazione numero 101, ed è quindi pari a 125. Possiamo concludere che il 50% centrale delle osservazioni è quindi compreso fra 75 e 125; l'IQR è dato dalla differenza fra 125 e 74 e quindi è 50.

# Epilogo
`r newthought("Si conclude così")` il primo appuntamento di "_Keep Calm and EnGioI Statistics_", e speriamo che vi abbia fornito qualche minima, utile informazione. Probabilmente le nozioni discusse qui sopra sono già alla portata di tutti, ma sono per molti versi le basi per costruire tutti i concetti chiave della statistica, fra cui il teorema del limite centrale. Questo teorema rappresenta il fulcro su cui gira tutta (o quasi) la statistica inferenziale, che in fin dei conti è quella che più ci interessa.  
Vi invitiamo a fornirci i vostri commenti sulla pagina di Facebook di EnGioI ([__link__](https://m.facebook.com/engioi/)) o via mail ai nostri indirizzi di posta elettronica ([__Andrea__](mailto:andreasansone85@gmail.com) e [__Angelo__](mailto:angelo.cignarelli@gmail.com)).  
Cercheremo di scrivere il prossimo "capitolo" nei prossimi giorni... Stay tuned!

`r newthought("Nella prossima puntata")` di _Keep Calm and EnGioI Statistics_, discuteremo di alcuni dei più annosi dilemmi del mondo moderno: come arroventare a puntino il ferro per punzonare le vostre vacche? Mentre per i vegetariani, come allacciarsi le scarpe con una mano sola? Le risposte a questi ed altri interessanti quesiti vi aspettano nel prossimo episodio di _Keep Calm and EnGioI Statistics_.